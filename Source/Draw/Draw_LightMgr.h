//==============================================================================
// Filename: Draw_LightMgr.h
// Description: ライトマネージャ
// Copyright (C) 2022 Silicon Studio Co., Ltd. All rights reserved.
//==============================================================================

#pragma once

//===== インクルード部 =====
#include <Draw/Draw_Light.h>

//===== 前方宣言 =====
template<typename C>
class GfxPixelCBuffer;

//===== クラス定義 =====

//***** ライトマネージャ *****
class DrawLightMgr
{
public:

    //バッファパック
    struct LightPack
    {
        //----------------------------------------------------------------------

        //----------------------------------------------------------------------
        /// コンストラクタ
        ///
        /// \return void
        //----------------------------------------------------------------------
        LightPack() noexcept :
            directionalLight(), ambientLight(1.0f, 1.0f, 1.0f, 0.2f)
        {}

        //----------------------------------------------------------------------
        /// デストラクタ
        ///
        /// \return void
        //----------------------------------------------------------------------
        ~LightPack() noexcept
        {}

        //----------------------------------------------------------------------

        //----------------------------------------------------------------------
        DrawLight::LightDirectional directionalLight;
        DirectX::XMFLOAT4 ambientLight;
        //----------------------------------------------------------------------

        /// <summary>
        /// directionalLight    平行光源
        /// ambientLight        環境光
        /// </summary>
    };

    //--------------------------------------------------------------------------

    //--------------------------------------------------------------------------
    /// コンストラクタ
    ///
    /// \param[in] app  App参照
    ///
    /// \return void
    //--------------------------------------------------------------------------
    DrawLightMgr(
        /*[in]*/ App64& app) noexcept;

    //--------------------------------------------------------------------------
    /// デストラクタ
    ///
    /// \return void
    //--------------------------------------------------------------------------
    ~DrawLightMgr() noexcept;

    //--------------------------------------------------------------------------
    /// 描画処理
    ///
    /// \return void
    //--------------------------------------------------------------------------
    void Draw() noexcept;

    //--------------------------------------------------------------------------
    /// ライト情報参照
    ///
    /// \return ライト情報の参照先
    //--------------------------------------------------------------------------
    LightPack& GetData() noexcept
    {
        return m_lightData;
    }

    //--------------------------------------------------------------------------

private:

    //--------------------------------------------------------------------------
    GfxPack& m_gfx;
    LightPack m_lightData;
    GfxPixelCBuffer<DrawLightMgr::LightPack>* m_pcBuff;
    //--------------------------------------------------------------------------

    /// <summary>
    /// m_gfx           描画データ参照先
    /// m_lightData     ライト情報
    /// m_pcBuff        定数バッファ
    /// </summary>
};
